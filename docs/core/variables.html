<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <title>o42a Â» Variables</title>

  <link rel="stylesheet" type="text/css" href="../../media/css/o42a.css" media="screen, projection" />
  <link rel="stylesheet" type="text/css" href="../../media/css/bootstrap.min.css" media="screen, projection" />
  <link rel="stylesheet" type="text/css" href="../../media/css/pygments.css" media="screen, projection" />

  
  <!-- Google Analytics -->
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-20313524-1']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  

  <script type="text/javascript">
    var root_path = "../../";
  </script>
</head>
<body>
  <div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container-fluid">
        <button
            id="magic-btn"
            type="button"
            class="btn btn-navbar"
            data-toggle="collapse"
            data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <div class="pull-right">
          <a
              class="brand"
              href="../../index.html">
            o42a Programming Language
          </a>
        </div>
        <div class="nav-collapse collapse">
          <ul class="nav">
            <li >
              <a href="../intro/features.html">
                Features
              </a>
            </li>
            <li class="active">
              <a href="../index.html">
                Documentation
              </a>
            </li>
            <li >
              <a href="../../devel/index.html">
                Development
              </a>
            </li>
            <li >
              <a href="../../downloads.html">
                Downloads
              </a>
            </li>
            <li>
              <a href="https://bitbucket.org/o42a/o42a/issues?status=new&amp;status=open">
                Issues
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  
    <div class="container-fluid">
      <ul class="breadcrumb">
            <li>
              <a href="../../index.html">o42a</a>
              <span class="divider">/</span>
            </li>
            <li>
              <a href="../index.html">Documentation</a>
              <span class="divider">/</span>
            </li>
            <li>
              <a href="./index.html">Core Objects</a>
              <span class="divider">/</span>
            </li>
      </ul>
    </div>
  

  <div class="container-fluid">
     <div class="row-fluid">
  <div class="span9">
    <h1 id="variables">Variables</h1>
<!--
Copyright (C) 2010-2013 Ruslan Lopatin.
Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3
or any later version published by the Free Software Foundation;
with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.
A copy of the license is included in the section entitled "GNU
Free Documentation License".
-->

<p>A variable is a link, which target can be re-assigned at run time.</p>
<p>The variable can be constructed with a variable unary operator:</p>
<blockquote>
<p><code>'``' &lt;initializer&gt;</code></p>
</blockquote>
<p>, by utilizing <a href="type_parameters.html#type_arguments">type arguments</a>:</p>
<blockquote>
<p><code>&lt;interface&gt; '`' 'variable' '[=' &lt;initializer&gt; ']'</code></p>
</blockquote>
<p>or, when declaring a variable field:</p>
<blockquote>
<p><code>&lt;field&gt; [':'] {'='|'=&gt;'|'=&lt;'|'=&lt;&gt;'} &lt;interface&gt; '`' 'variable' '=' &lt;initializer&gt;</code></p>
</blockquote>
<p>where:</p>
<ul>
<li><code>&lt;field&gt;</code> is a left part of either
  <a href="../objects/fields.html#field_declaration">field</a> or
  <a href="../objects/adapters.html#adapter_declaration">adapter</a> declaration;</li>
<li><code>&lt;initializer&gt;</code> is initial variable value, which will be assigned to
  variable at first access, unless new target <a href="#variable_assignment">assigned</a>
  first;</li>
<li><code>&lt;interface&gt;</code> is a variable interface reference, similarly to the
  <a href="links.html#link_interface">link interface</a>.</li>
</ul>
<p>Variables are used mostly the same way as links.</p>
<h2 id="assignment">Assignment</h2>
<p>The variable target can be re-assigned inside
an <a href="../sentences/imperatives.html">imperative block</a> with assignment statement.</p>
<p>There are two kinds of assignment statements supported:</p>
<ul>
<li>binding: <code>&lt;target&gt; '&lt;-' &lt;value&gt;</code></li>
<li>value assignment: <code>&lt;target&gt; '=' &lt;value&gt;</code></li>
</ul>
<p>where <code>&lt;target&gt;</code> is an assignment target (e.g. variable), and <code>&lt;value&gt;</code> is a
value to assign to the <code>&lt;target&gt;</code>.</p>
<p>Note that unlike initial variable target, the <code>&lt;value&gt;</code> will be resolved and
assigned immediately at assignment statement execution.</p>
<blockquote>
<p>Also note that the value assignment statement syntax is similar to the field
override one. That's because the field override is impossible inside
imperative blocks.</p>
</blockquote>
<p>The assignments are also possible inside a declarative code. But the value
assignment requires a special syntax, as otherwise it conflicts with a field
override syntax.</p>
<p>The assignment syntax acceptable for both imperative and declarative code is
based on a <a href="../sentences/locals.html#local_scope">local scope</a> declaration
syntax:</p>
<blockquote>
<p><code>&lt;target&gt; '$' [&lt;local name&gt;] {'=' | '&lt;-'} &lt;value&gt;</code></p>
</blockquote>
<p>where <code>&lt;local name&gt;</code> is an optional name for declared local, which value is an
assignment target.</p>
<p>As for any local scope declaration, the local name can be omitted.</p>
<p>Note that such syntax allows to use the declared local inside a value
expression. This makes it possible to implement things like increment without
re-evaluating the target variable:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre>Array [n] $= $ + 1 ~~ Increment the Nth element of array.
</pre></div>
</td></tr></table>

<h3 id="binding">Binding</h3>
<p>The binding statement just assigns a new value to the target.</p>
<p>In the binding target is variable, then it stores an object the value is
evaluated to, in the variable and does nothing else.</p>
<h3 id="value_assignment">Value Assignment</h3>
<p>The value assignment statement is a combination of actions making it behave more
like a traditional imperative assignments.</p>
<p>The value assignment does the following:</p>
<ul>
<li>Makes the value stateful (exactly like a <a href="../expressions/unary.html#keep_value">keep value</a> operator).</li>
<li>Evaluates its value.</li>
<li>Assigns the value to the target just like binding.</li>
</ul>
<p>A good example of why this is needed is loops. Lets look at the following loop:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre>``3 $ i {
  I &lt;- i - 1
  I &gt; 0?...
}
</pre></div>
</td></tr></table>

<p>It does what expected: loops three times and exits. But how this happens? In
fact the binding operator each time constructs a new object <code>i - 1</code> and stores
it in variable <code>i</code>. For the first time this will be a <code>3 - 1</code>, for the second
time this will be <code>(3 - 1) - 1</code>, for the last time this will be
<code>((3 - 1) - 1) - 1</code>. See? Each time the value of object stored in <code>i</code> requested,
its value will be re-evaluated. What if the loop is much longer?</p>
<p>The solution is to <a href="../expressions/unary.html#keep_value">keep its value</a>. Then the value will be
evaluated at most once. But the value will be evaluated only when requested.
The value assignment evaluates it explicitly, making it behave just like in
traditional imperative programming languages. If the explicit value evaluation
fails, then the binding won't happen and the assignment target remain unchanged.</p>
<p>So, if replace the binding (<code>&lt;-</code>) in the code above with the value assignment
(<code>=</code>), the loop will work as expected, without additional overhead and without
boilerplate.</p>
<h3 id="combined_assignment">Combined Assignment</h3>
<p>A combined assignment statement combines an arithmetic operation with value
assignment. The following statements supported:</p>
<ul>
<li><code>&lt;target&gt; '+=' &lt;value&gt;</code> - add and assign;</li>
<li><code>&lt;target&gt; '-=' &lt;value&gt;</code> - subtract and assign;</li>
<li><code>&lt;target&gt; '*=' &lt;value&gt;</code> - multiply and assign;</li>
<li><code>&lt;target&gt; '/=' &lt;value&gt;</code> - divide and assign.</li>
</ul>
<p>The statement like this: <code>a += b</code> is the same as <code>a = a + b</code>, given the <code>a</code> is
evaluated only once. So, the more correct code would be
<code>a $ tmp (tmp = tmp + b)</code>. Combined assignments avoid this boilerplate.</p>
<h2 id="variable_object">Variable Object</h2>
<p>Every variable is an object inherited from the <code>Variable</code> prototype and can be
used similarly to the <a href="links.html#link_object">link one</a>.</p>
  </div>
  <div class="span3 well">
    <ul class="nav nav-list">
  <li class=" nav-header">
      <a href="../intro/index.html">Introduction</a>
  </li>
  
  <li class=" nav-header">
      <a href="../syntax/index.html">Basic Syntax</a>
  </li>
  
  <li class=" nav-header">
      <a href="../objects/index.html">Objects</a>
  </li>
  
  <li class=" nav-header">
      <a href="../expressions/index.html">Expressions</a>
  </li>
  
  <li class=" nav-header">
      <a href="../sentences/index.html">Sentences</a>
  </li>
  
  <li class=" nav-header">
      <a href="../phrases/index.html">Phrases</a>
  </li>
  
  <li class=" nav-header">
      <a href="../core/index.html">Core Objects</a>
  </li>
  <li>
      <ul class="nav nav-list">
  <li class="">
      <a href="../core/links.html">Links</a>
  </li>
  
  <li class="active">
      <a href="../core/variables.html">Variables</a>
  </li>
  
  <li class="">
      <a href="../core/arrays.html">Arrays</a>
  </li>
  
  <li class="">
      <a href="../core/macros.html">Macros</a>
  </li>
  
  <li class="">
      <a href="../core/type_parameters.html">Type Parameters</a>
  </li>
  
  </ul>
    </li>
  <li class=" nav-header">
      <a href="../sources/index.html">Source Files</a>
  </li>
  
  </ul>
  </div>
</div>
  </div>

  <footer class="footer">
    <div class="container-fluid">
      <p>
        Powered by <a href="http://markdoc.org/">Markdoc</a>
      </p>
      <ul class="footer-links">
        <li>
          <a href="../../imprint.html">Imprint</a>
        </li>
      </ul>
    </div>
  </footer>

  <script type="application/javascript" src="../../media/js/jquery.min.js"></script>
    <script type="application/javascript" src="../../media/js/bootstrap.min.js"></script>
  
</body>
</html>